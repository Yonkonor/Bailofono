<!DOCTYPE html>
<html>
<head>
	<title>Sintetizador de acorde mayor</title>
</head>
<body>

	<!-- Bot贸n para encender y apagar el sonido -->
	<button id="btnOnOff" onclick="toggleSound()" ontouchstart="toggleSound()">Encender sonido</button>

	<!-- Barra para seleccionar la frecuencia fundamental del acorde -->
	<input id="barraFrecuencia" type="range" min="1" max="12" step="1" value="1">

	<script>

		// Variables globales
		var context = new AudioContext();
		var oscillator;
		var armonicoAnterior;
		var armonicoPosterior;
		var gainNode;
		var playing = false;

		// Funci贸n para encender y apagar el sonido
		function toggleSound() {
			if (playing) {
				oscillator.stop();
				armonicoAnterior.stop();
				armonicoPosterior.stop();
				playing = false;
				document.getElementById("btnOnOff").innerHTML = "Encender sonido";
			} else {
				oscillator = context.createOscillator();
				armonicoAnterior = context.createOscillator();
				armonicoPosterior = context.createOscillator();
				gainNode = context.createGain();

				// Establecer la frecuencia fundamental del acorde
				var barra = document.getElementById("barraFrecuencia");
				var frecuencia = Math.pow(2, (barra.value - 1) / 12) * 220;
				oscillator.frequency.value = frecuencia;

				// Generar los arm贸nicos anterior y posterior
				armonicoAnterior.frequency.value = frecuencia * (5/6);
				armonicoPosterior.frequency.value = frecuencia * (7/6);

				// Conectar los nodos de audio
				oscillator.connect(gainNode);
				armonicoAnterior.connect(gainNode);
				armonicoPosterior.connect(gainNode);
				gainNode.connect(context.destination);

				// Establecer las intensidades relativas de los arm贸nicos
				gainNode.gain.value = 1/3;
				armonicoAnterior.connect(gainNode);
				armonicoAnterior.gain.value = 1/3;
				armonicoPosterior.connect(gainNode);
				armonicoPosterior.gain.value = 1/3;

				// Iniciar los osciladores
				oscillator.start();
				armonicoAnterior.start();
				armonicoPosterior.start();

				playing = true;
				document.getElementById("btnOnOff").innerHTML = "Apagar sonido";
			}
		}

		// Actualizar la frecuencia fundamental del acorde cuando se mueve la barra
		var barraFrecuencia = document.getElementById("barraFrecuencia");
		barraFrecuencia.addEventListener("input", function() {
			var frecuencia = Math.pow(2, (this.value - 1) / 12) * 220;
			oscillator.frequency.value = frecuencia;
			armonicoAnterior.frequency.value = frecuencia * (5/6);
			armonicoPosterior.frequency.value = frecuencia * (7/6);
		});

	</script>

</body>
</html>
