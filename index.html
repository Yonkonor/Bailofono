<!DOCTYPE html>
<html>
<head>
	<title>Sintetizador de acorde mayor</title>
	style>
		.container {
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			height: 100vh;
		}

		#btnOnOff {
			width: 300px;
			height: 90px;
		}

		#barraFrecuencia {
			width: 300px;
			height: 90px;
		}
	</style>
</head>
<body>

	<!-- Bot贸n para encender y apagar el sonido -->
	<button id="btnOnOff" onclick="toggleSound()" ontouchstart="toggleSound()">Encender sonido</button>

	<!-- Barra para seleccionar la frecuencia fundamental del acorde -->
	<input id="barraFrecuencia" type="range" min="1" max="12" step="1" value="1">

	<script>

		// Variables globales
		var context;
		var oscillator;
		var armonicoAnterior;
		var armonicoPosterior;
		var gainNode;
		var playing = false;

		// Crear el contexto de audio
		try {
			window.AudioContext = window.AudioContext || window.webkitAudioContext;
			context = new AudioContext();
		} catch(e) {
			alert("Tu navegador no soporta AudioContext.");
		}

		// Funci贸n para encender y apagar el sonido
		function toggleSound() {
			if (playing) {
				oscillator.stop();
				armonicoAnterior.stop();
				armonicoPosterior.stop();
				playing = false;
				document.getElementById("btnOnOff").innerHTML = "Encender sonido";
			} else {
				oscillator = context.createOscillator();
				armonicoAnterior = context.createOscillator();
				armonicoPosterior = context.createOscillator();
				gainNode = context.createGain();

				// Establecer la frecuencia fundamental del acorde
				var barra = document.getElementById("barraFrecuencia");
				var frecuencia = Math.pow(2, (barra.value - 1) / 12) * 220;
				oscillator.frequency.value = frecuencia;

				// Generar los arm贸nicos anterior y posterior
				armonicoAnterior.frequency.value = frecuencia * (5/6);
				armonicoPosterior.frequency.value = frecuencia * (7/6);

				// Conectar los nodos de audio
				oscillator.connect(gainNode);
				armonicoAnterior.connect(gainNode);
				armonicoPosterior.connect(gainNode);
				gainNode.connect(context.destination);

				// Establecer las intensidades relativas de los arm贸nicos
				gainNode.gain.value = 1/3;
				armonicoAnterior.connect(gainNode);
				armonicoAnterior.gain.value = 1/3;
				armonicoPosterior.connect(gainNode);
				armonicoPosterior.gain.value = 1/3;

				/ Iniciar los osciladores
				oscillator.start();
				armonicoAnterior.start();
				armonicoPosterior.start();

				playing = true;
				document.getElementById("btnOnOff").innerHTML = "Apagar sonido";

				// Detener los osciladores y el contexto de audio al cerrar la ventana
				window.onbeforeunload = function() {
				oscillator.stop();
				armonicoAnterior.stop();
				armonicoPosterior.stop();
				context.close();
				};

				</script>
				</body>
				</html>
